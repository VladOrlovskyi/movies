(this.webpackJsonpproject_1=this.webpackJsonpproject_1||[]).push([[0],{115:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"fetchAuth",(function(){return S})),n.d(a,"updateAuth",(function(){return F})),n.d(a,"fetchFavoriteMovies",(function(){return M})),n.d(a,"updateFavoriteMovies",(function(){return P})),n.d(a,"onLogOut",(function(){return A})),n.d(a,"toggleLoginModal",(function(){return D}));var i=n(0),s=n.n(i),r=n(22),o=n.n(r),c=n(5),l=n(6),u=n(8),d=n(7),j=(n(80),n(128)),h=n(137),b=n(139),p=n(129),v=n(9),m=n(37),O=n(27),g="LOGOUT",f="TOGGLE_LOGIN_MODAL",x="UPDATE_FAVORITE_MOVIES",_="FETCH_SUCCESS_AUTH",y=n(38),C=n.n(y),N="https://api.themoviedb.org/3",k="3f4ca4f3a9750da53450646ced312397",w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,a){fetch(e,t).then((function(e){if(e.status<400)return e.json();throw e})).then((function(e){n(e)})).catch((function(e){e.json().then((function(e){a(e)}))}))}))},L=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.params,a=void 0===n?{}:n,i=Object(v.a)({api_key:k},a);return w("".concat(N).concat(e,"?").concat(C.a.stringify(i)),{mode:"cors",headers:{"Content-type":"application/json"}})}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.params,a=void 0===n?{}:n,i=t.body,s=void 0===i?{}:i,r=Object(v.a)({api_key:k},a);return w("".concat(N).concat(e,"?").concat(C.a.stringify(r)),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(s)})}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.params,a=void 0===n?{}:n,i=t.body,s=void 0===i?{}:i,r=Object(v.a)({api_key:k},a);return w("".concat(N).concat(e,"?").concat(C.a.stringify(r)),{method:"DELETE",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(s)})}}]),e}(),S=function(e){return function(t){t({type:"FETCH_REQUEST_AUTH"}),L.get("/account",{params:{session_id:e}}).then((function(n){t(F({user:n,session_id:e})),t(M({user:n,session_id:e}))})).catch((function(e){t({type:"FETCH_ERROR_AUTH",payload:e})}))}},F=function(e){return{type:"FETCH_SUCCESS_AUTH",payload:{user:e.user,session_id:e.session_id}}},M=function(e){var t=e.user,n=e.session_id;return function(e){L.get("/account/".concat(t.id,"/favorite/movies"),{params:{session_id:n}}).then((function(t){e(P(t.results))}))}},P=function(e){return{type:"UPDATE_FAVORITE_MOVIES",payload:e}},A=function(){return{type:"LOGOUT"}},D=function(){return{type:"TOGGLE_LOGIN_MODAL"}},T=n(1),E=function(e){return{auth:e.auth}},I=function(e){return{authActions:Object(O.bindActionCreators)(a,e)}},R=function(e){return Object(m.b)(E,I)(function(t){Object(u.a)(a,t);var n=Object(d.a)(a);function a(){return Object(c.a)(this,a),n.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(T.jsx)(e,Object(v.a)({},this.props))}}]),a}(s.a.Component))},U=n(17),B=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={dropdownOpen:!1},e.toggleDropdown=function(){e.setState((function(e){return{dropdownOpen:!e.dropdownOpen}}))},e.handleLogOut=function(){L.delete("/authentication/session",{body:{session_id:e.props.auth.session_id}}).then((function(){e.props.authActions.onLogOut()}))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.auth;return Object(T.jsxs)(j.a,{isOpen:this.state.dropdownOpen,toggle:this.toggleDropdown,children:[Object(T.jsx)(h.a,{tag:"div",onClick:this.toggleDropdown,"data-toggle":"dropdown","aria-expanded":this.state.dropdownOpen,children:Object(T.jsx)("img",{width:"40",className:"rounded-circle",src:"https://secure.gravatar.com/avatar/".concat(e.user.avatar.gravatar.hash,'.jpg?s=64"'),alt:"",onClick:this.toggleDropdown})}),Object(T.jsxs)(b.a,{right:!0,children:[Object(T.jsx)(p.a,{className:"dropdown-item-user-menu-btn",children:Object(T.jsx)(U.b,{to:"/account/".concat(e.user.id,"/favorite/movies"),className:"user-menu-btn",children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0435"})}),Object(T.jsx)(p.a,{onClick:this.handleLogOut,className:"dropdown-item-user-menu-btn",children:Object(T.jsx)(U.b,{to:"/",className:"user-menu-btn",children:"\u0412\u044b\u0439\u0442\u0438"})})]})]})}}]),n}(i.Component)),G=n(138),H=n(130),V=n(24),q=function(e){var t={};return""===e.username&&(t.username="Not empty"),""===e.password&&(t.password="Required"),t},W=n(13),J=n.n(W),$=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.labelText,a=e.type,i=e.placeholder,s=e.name,r=e.value,o=e.onChange,c=e.handleBlur,l=e.error;return Object(T.jsxs)("div",{className:"form-group",children:[Object(T.jsx)("label",{htmlFor:t,children:n}),Object(T.jsx)("input",{type:a,className:J()("form-control",{invalid:l}),id:t,placeholder:i,name:s,value:r,onChange:o,onBlur:c}),l&&Object(T.jsx)("div",{className:"invalid-feedback",children:l})]})}}]),n}(s.a.Component),Q=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChange=function(t){var n=t.target.name,a=t.target.value;e.setState((function(e){return{values:Object(v.a)(Object(v.a)({},e.values),{},Object(V.a)({},n,a)),errors:Object(v.a)(Object(v.a)({},e.errors),{},Object(V.a)({base:null},n,null))}}))},e.handleBlur=function(){console.log("on blur");var t=q(e.state.values);Object.keys(t).length>0&&e.setState((function(e){return{errors:Object(v.a)(Object(v.a)({},e.errors),t)}}))},e.onSubmit=function(){var t=e.state.values,n=t.username,a=t.password,i=null;e.setState({submitting:!0}),L.get("/authentication/token/new").then((function(e){return L.post("/authentication/token/validate_with_login",{body:{username:n,password:a,request_token:e.request_token}})})).then((function(e){return L.post("/authentication/session/new",{body:{request_token:e.request_token}})})).then((function(e){return i=e.session_id,L.get("/account",{params:{session_id:e.session_id}})})).then((function(t){e.setState({submitting:!1},(function(){e.props.authActions.updateAuth({user:t,session_id:i}),e.props.authActions.toggleLoginModal()}))})).catch((function(t){console.log("error",t),e.setState({submitting:!1,errors:{base:t.status_message}})}))},e.onLogin=function(t){t.preventDefault();var n=q(e.state.values);Object.keys(n).length>0?e.setState((function(e){return{errors:Object(v.a)(Object(v.a)({},e.errors),n)}})):e.onSubmit()},e.getClassForInput=function(t){return J()("form-control",{invalid:e.state.errors[t]})},e.state={values:{username:"",password:""},errors:{},submitting:!1},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state,t=e.values,n=t.username,a=t.password,i=e.errors,s=e.submitting;return Object(T.jsx)("div",{className:"form-login-container",children:Object(T.jsxs)("form",{className:"form-login",children:[Object(T.jsx)("h1",{className:"h3 mb-3 font-weight-normal text-center",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(T.jsx)($,{id:"username",labelText:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",type:"text",placeholder:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",name:"username",value:n,onChange:this.onChange,handleBlur:this.handleBlur,error:i.username}),Object(T.jsx)($,{id:"password",labelText:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",value:a,onChange:this.onChange,handleBlur:this.handleBlur,error:i.password}),Object(T.jsx)("button",{type:"submit",className:" btn btn-lg btn-primary btn-block",onClick:this.onLogin,disabled:s,children:"\u0412\u0445\u043e\u0434"}),i.base&&Object(T.jsx)("div",{className:"invalid-feedback text-center",children:i.base})]})})}}]),n}(s.a.Component)),z=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.auth,n=e.authActions;return Object(T.jsxs)("div",{children:[Object(T.jsx)("div",{className:"btn login-btn btn-success",onClick:n.toggleLoginModal,children:"\u0412\u043e\u0439\u0442\u0438"}),Object(T.jsx)(G.a,{isOpen:t.showLoginModal,toggle:n.toggleLoginModal,children:Object(T.jsx)(H.a,{children:Object(T.jsx)(Q,{})})})]})}}]),n}(s.a.Component)),K=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.auth;return Object(T.jsx)("nav",{className:"navbar",children:Object(T.jsxs)("div",{className:"container",children:[Object(T.jsx)("ul",{className:"navbar-nav",children:Object(T.jsx)("li",{className:"nav-item active",children:Object(T.jsx)(U.b,{className:"nav-link",to:"/",children:Object(T.jsx)("span",{children:"MOVIES"})})})}),e.user?Object(T.jsx)(B,{}):Object(T.jsx)(z,{})]})})}}]),n}(s.a.Component)),X=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.sort_by,n=e.onChangeFilters,a=e.options;return Object(T.jsxs)("div",{className:"form-group",children:[Object(T.jsx)("label",{htmlFor:"sort_by",children:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"}),Object(T.jsx)("select",{id:"sort_by",className:"form-control",name:"sort_by",value:t,onChange:n,children:a.map((function(e){return Object(T.jsx)("option",{value:e.value,children:e.label},e.value)}))})]})}}]),n}(s.a.Component);X.defaultProps={options:[{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e:",value:"popularity.desc"},{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e:",value:"popularity.asc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e:",value:"vote_average.desc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e:",value:"vote_average.asc"}]};var Y=function(){for(var e=[],t=2021;t>=2e3;t--)e.push(t);return e}(),Z=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.primary_release_year,n=e.onChangeFilters;return Object(T.jsxs)("div",{className:"form-group",children:[Object(T.jsx)("label",{htmlFor:"primary_release_year",children:"\u0413\u043e\u0434 \u0440\u0435\u043b\u0438\u0437\u0430:"}),Object(T.jsxs)("select",{className:"form-control",id:"primary_release_year",name:"primary_release_year",value:t,onChange:n,children:[Object(T.jsx)("option",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0434"}),Y.map((function(e){return Object(T.jsx)("option",{value:e,children:e},e)}))]})]})}}]),n}(s.a.PureComponent),ee=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.page,n=e.total_pages,a=e.onChangePagination;return Object(T.jsxs)("div",{children:[Object(T.jsxs)("div",{className:"btn-group btn-pagination",children:[Object(T.jsx)("button",{type:"button",className:"btn mr-2",disabled:1===t,onClick:a.bind(null,t-1,n),children:"\u041d\u0430\u0437\u0430\u0434"}),Object(T.jsx)("button",{type:"button",className:"btn",onClick:a.bind(null,t+1,n),children:"\u0412\u043f\u0435\u0440\u0435\u0434"})]}),Object(T.jsxs)("div",{className:"page-pagination",children:[t," \u0438\u0437 ",n]})]})}}]),n}(s.a.Component),te=n(71),ne=function(e){var t=e.genresList,n=e.with_genres,a=e.onChange;return Object(T.jsxs)("div",{className:"filters__form-genres genres",children:[Object(T.jsx)("div",{className:"genres__choice",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0436\u0430\u043d\u0440:"}),t.map((function(e){return Object(T.jsxs)("div",{className:"form-check",children:[Object(T.jsx)("input",{className:"form-check-input",type:"checkbox",name:"with_genres",value:e.id,id:"genre".concat(e.id),onChange:a,checked:n.includes(String(e.id))}),Object(T.jsx)("label",{className:"form-check-label",htmlFor:"genre".concat(e.id),children:e.name})]},e.id)}))]})};ne.defaultProps={genresList:[],with_genres:[]};var ae,ie=(ae=ne,function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChange=function(t){e.props.onChangeFilters({target:{name:"with_genres",value:t.target.checked?[].concat(Object(te.a)(e.props.with_genres),[t.target.value]):e.props.with_genres.filter((function(e){return e!==t.target.value}))}})},e.state={genresList:[]},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t="".concat(N,"/genre/movie/list?api_key=").concat(k,"&language=ru-RU");fetch(t).then((function(e){return e.json()})).then((function(t){e.setState({genresList:t.genres})}))}},{key:"render",value:function(){var e=this.state.genresList,t=this.props.with_genres;return Object(T.jsx)(ae,{genresList:e,with_genres:t,onChange:this.onChange})}}]),n}(s.a.Component)),se=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.filters,n=t.sort_by,a=t.primary_release_year,i=t.with_genres,s=e.pagination,r=s.page,o=s.total_pages,c=e.onChangeFilters,l=e.onChangePagination,u=e.onReset;return Object(T.jsxs)("form",{className:"filters_form",children:[Object(T.jsx)("div",{children:Object(T.jsx)("button",{type:"button",className:"btn btn-outline-dark clear-btn",onClick:u,children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"})}),Object(T.jsx)(X,{sort_by:n,onChangeFilters:c}),Object(T.jsx)(Z,{primary_release_year:a,onChangeFilters:c}),Object(T.jsx)("div",{className:"mb-3",children:Object(T.jsx)(ie,{with_genres:i,onChangeFilters:c})}),Object(T.jsx)(ee,{page:r,total_pages:o,onChangePagination:l})]})}}]),n}(s.a.Component),re=n(131),oe=n(132),ce=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).markAsFavorite=function(){var t=e.props,n=t.auth,a=(t.user,t.session_id),i=t.movieId,s=t.favoriteMovies,r=(t.updateFavoriteMovies,t.authActions);a?e.setState({isLoading:!0},(function(){L.post("/account/".concat(n.user.id,"/favorite"),{params:{session_id:e.props.auth.session_id},body:{media_type:"movie",media_id:i,favorite:!e.getCurrentFavorite(s,i)}}).then((function(){r.updateFavoriteMovies().then((function(){e.setState({isLoading:!1})}))}))})):r.toggleLoginModal(),console.log("auth",n),console.log("auth user",n.user),console.log("auth user id",n.user.id)},e.getCurrentFavorite=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;e.some((function(e){return e.id===t}))},e.state={isLoading:!1},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state.isLoading,t=this.props,n=t.favoriteMovies,a=t.movieId,i=this.getCurrentFavorite(n,a);return Object(T.jsx)("div",{className:"d-inline-flex mark-favorite",onClick:this.markAsFavorite,style:{pointerEvents:e?"none":"auto"},children:i?Object(T.jsx)(re.a,{}):Object(T.jsx)(oe.a,{})})}}]),n}(s.a.PureComponent)),le=n(133),ue=n(134),de=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).addToWatchList=function(){var t=e.props,n=t.user,a=t.session_id,i=t.movieId,s=t.watchlist,r=t.getWatchList,o=t.authActions;a?e.setState({isLoading:!0},(function(){L.post("/account/".concat(n.id,"/watchlist"),{params:{session_id:a},body:{media_type:"movie",media_id:i,watchlist:!e.getCurrentWatchList(s,i)}}).then((function(){r().then((function(){e.setState({isLoading:!1})}))}))})):o.toggleLoginModal()},e.getCurrentWatchList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.some((function(e){return e.id===t}))},e.state={isLoading:!1},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state.isLoading,t=this.props,n=t.watchlist,a=t.movieId,i=this.getCurrentWatchList(n,a);return Object(T.jsx)("div",{className:"d-inline-flex mark-watch",onClick:this.addToWatchList,style:{pointerEvents:e?"none":"auto"},children:i?Object(T.jsx)(le.a,{}):Object(T.jsx)(ue.a,{})})}}]),n}(s.a.PureComponent)),je=n(73),he=n.p+"static/media/default-image.469e6448.png",be=["path"],pe=function(e){var t=e.path,n=Object(je.a)(e,be);return t?Object(T.jsx)("img",Object(v.a)(Object(v.a)({src:"https://image.tmdb.org/t/p/w500".concat(t)},n),{},{alt:""})):Object(T.jsx)("img",Object(v.a)(Object(v.a)({src:he},n),{},{alt:""}))},ve=n(50),me=(n(112),function(e){var t=10*e.vote_average,n=t>70?"#1eff00":"#ff0000";return Object(T.jsx)(ve.a,{value:t,text:"".concat(t,"%"),background:!0,backgroundPadding:8,styles:Object(ve.b)({backgroundColor:"#081c24",textColor:"#fff",pathColor:n,trailColor:"transparent",pathTransition:3e3,pathTransitionDuration:5.5})})}),Oe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.item;return Object(T.jsx)("div",{className:"card",children:Object(T.jsxs)("div",{className:"card-body card-movie",children:[Object(T.jsx)("div",{className:"card-movie_img",children:Object(T.jsx)(U.b,{to:"/movie/".concat(e.id,"/details"),children:Object(T.jsx)(pe,{className:"card-img-top card-img--height",alt:"",path:e.poster_path||e.backdrop_path})})}),Object(T.jsxs)("div",{className:"card-movie_description",children:[Object(T.jsxs)("div",{className:"card-movie_icons",children:[Object(T.jsx)(me,{vote_average:e.vote_average}),Object(T.jsx)(ce,{movieId:e.id}),Object(T.jsx)(de,{movieId:e.id})]}),Object(T.jsx)(U.b,{className:"card-title card-movie_name",to:"/movie/".concat(e.id,"/details"),children:e.title}),Object(T.jsx)("div",{className:"card-movie_details",children:Object(T.jsx)(U.b,{to:"/movie/".concat(e.id,"/details"),children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})})]})]})})}}]),n}(s.a.Component),ge=n(36),fe=n.n(ge),xe=function(e){var t=e.movies;return Object(T.jsx)("div",{className:"row",children:t.map((function(e){return Object(T.jsx)("div",{className:"col-6 mb-4",children:Object(T.jsx)(Oe,{item:e})},e.id)}))})};xe.defaultProps={movies:[]};var _e=function(e){return function(t){Object(u.a)(a,t);var n=Object(d.a)(a);function a(){var e;return Object(c.a)(this,a),(e=n.call(this)).getMovies=function(t,n){var a=t.sort_by,i=t.primary_release_year,s=t.with_genres,r={language:"ru-RU",sort_by:a,page:n,primary_release_year:i,with_genres:s};s.length>0&&(r.with_genres=s.join(",")),L.get("/discover/movie",{params:r}).then((function(t){e.props.onChangePagination(n,t.total_pages),e.setState({movies:t.results})}))},e.state={movies:[]},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getMovies(this.props.filters,this.props.pagination.page)}},{key:"componentDidUpdate",value:function(e){fe.a.isEqual(this.props.filters,e.filters)||this.getMovies(this.props.filters,1),this.props.pagination.page!==e.pagination.page&&this.getMovies(this.props.filters,this.props.pagination.page)}},{key:"render",value:function(){var t=this.state.movies;return Object(T.jsx)(e,{movies:t})}}]),a}(s.a.Component)}(xe),ye=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChangeFilters=function(t){var n=t.target.value,a=t.target.name;e.setState((function(e){return{filters:Object(v.a)(Object(v.a)({},e.filters),{},Object(V.a)({},a,n))}}))},e.onChangePagination=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.pagination.total_pages;e.setState((function(e){return{pagination:Object(v.a)(Object(v.a)({},e.pagination),{},{page:t,total_pages:n})}}))},e.onReset=function(){e.setState(Object(v.a)({},e.initialState))},e.initialState={filters:{sort_by:"popularity.desc",primary_release_year:"",with_genres:[]},pagination:{page:1,total_pages:1}},e.state=Object(v.a)({},e.initialState),e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state,t=e.filters,n=e.pagination;return Object(T.jsx)("div",{className:"container",children:Object(T.jsxs)("div",{className:"row mt-4",children:[Object(T.jsx)("div",{className:"col-3",children:Object(T.jsx)("div",{className:"card w-100",children:Object(T.jsxs)("div",{className:"card-body",children:[Object(T.jsx)("h3",{children:"\u0424\u0438\u043b\u044c\u0442\u0440\u044b:"}),Object(T.jsx)(se,{pagination:n,filters:t,onChangeFilters:this.onChangeFilters,onChangePagination:this.onChangePagination,onReset:this.onReset})]})})}),Object(T.jsx)("div",{className:"col-9",children:Object(T.jsx)(_e,{filters:t,pagination:n,onChangePagination:this.onChangePagination})})]})})}}]),n}(s.a.Component),Ce=n(16),Ne=[{link:"\u0414\u0435\u0442\u0430\u043b\u0438",path:"details"},{link:"\u0412\u0438\u0434\u0435\u043e",path:"videos"},{link:"\u0410\u043a\u0442\u0435\u0440\u044b",path:"actors"}],ke=Object(Ce.f)((function(e){var t=e.match;return Object(T.jsx)("ul",{className:"nav nav-tabs movie-tabs",children:Ne.map((function(e,n){return Object(T.jsx)("li",{className:"nav-item movie-tabs_item",children:Object(T.jsx)(U.c,{to:"".concat(t.url,"/").concat(e.path),className:"nav-link ",children:e.link})},n)}))})})),we=n(135),Le=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.movieDetails,t=[{name:"\u0421\u0442\u0430\u0442\u0443\u0441",value:e.status},{name:"\u0414\u0430\u0442\u0430 \u0432\u044b\u0445\u043e\u0434\u0430",value:e.release_date},{name:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",value:"".concat(e.runtime,"\u043c\u0438\u043d\u0443\u0442")},{name:"\u042f\u0437\u044b\u043a \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u0430",value:e.original_language},{name:"\u0421\u0442\u0440\u0430\u043d\u0430",value:e.production_countries.map((function(e){return e.name}))},{name:"\u0411\u044e\u0434\u0436\u0435\u0442",value:"".concat(e.budget,"$")},{name:"\u0421\u0431\u043e\u0440\u044b",value:"".concat(e.revenue,"$")},{name:"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f",value:e.production_companies.map((function(e){return e.name}))},{name:"\u0416\u0430\u043d\u0440\u044b",value:e.genres.map((function(e){return e.name}))}];return Object(T.jsx)(we.a,{children:Object(T.jsx)("tbody",{children:t.map((function(e,t){return Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{scope:"row",children:e.name}),Object(T.jsx)("td",{children:"".concat(e.value)})]},t)}))})})}}]),n}(s.a.Component);Le.defaultProps={movieDetails:{production_countries:[],production_companies:[],genresList:[]}};var Se=n(136),Fe=function(){return Object(T.jsx)("div",{className:"row justify-content-center mt-4",children:Object(T.jsx)("div",{className:"col-3",children:Object(T.jsx)(Se.a,{color:"primary"})})})},Me=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={movieVideos:[],isLoading:!0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;L.get("/movie/".concat(t.id,"/videos")).then((function(t){e.setState({movieVideos:t.results,isLoading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.movieVideos;return e.isLoading?Object(T.jsx)(Fe,{}):Object(T.jsx)("div",{className:"row",children:t.map((function(e){return Object(T.jsx)("div",{className:"col-6",children:Object(T.jsx)("iframe",{title:"video",width:"100%",height:"260",src:"https://www.youtube.com/embed/".concat(e.key),frameborder:"0",allowFullScreen:!0})},e.id)}))})}}]),n}(s.a.Component),Pe=Object(Ce.f)(Me),Ae=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={movieActors:[],isLoading:!0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;L.get("/movie/".concat(t.id,"/credits")).then((function(t){e.setState({movieActors:t,isLoading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.movieActors;return e.isLoading?Object(T.jsx)(Fe,{}):Object(T.jsx)("div",{className:"row movie-actors",children:t.cast.map((function(e){return e.profile_path&&Object(T.jsxs)("div",{className:"col-3 movie-actors_item",children:[Object(T.jsx)(pe,{alt:"",path:e.profile_path}),Object(T.jsxs)("div",{className:"movie-actors_name",children:[Object(T.jsx)("h3",{children:e.name}),Object(T.jsx)("span",{children:e.character})]})]},e.id)}))})}}]),n}(s.a.Component),De=Object(Ce.f)(Ae),Te=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.movieDetails;return Object(T.jsx)("section",{className:"movie-details",children:Object(T.jsx)("div",{className:"container",children:Object(T.jsx)("div",{className:"row justify-content-center mt-4",children:Object(T.jsxs)("div",{className:"col-10",children:[Object(T.jsx)(ke,{}),Object(T.jsx)("div",{className:"content",children:Object(T.jsxs)(Ce.c,{children:[Object(T.jsx)(Ce.a,{path:"/movie/:id/details",children:Object(T.jsx)(Le,{movieDetails:e})}),Object(T.jsx)(Ce.a,{path:"/movie/:id/videos",component:Pe}),Object(T.jsx)(Ce.a,{path:"/movie/:id/actors",component:De})]})})]})})})})}}]),n}(s.a.Component),Ee=function(e){var t=e.title,n=e.overview,a=e.vote_average,i=e.movieId;return Object(T.jsxs)(s.a.Fragment,{children:[Object(T.jsx)("h1",{children:t}),Object(T.jsxs)("div",{children:[Object(T.jsx)(me,{vote_average:a}),Object(T.jsx)(ce,{movieId:i}),Object(T.jsx)(de,{movieId:i})]}),Object(T.jsx)("p",{children:n})]})},Ie=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={movieDetails:[],isLoading:!0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;L.get("/movie/".concat(t.id),{params:{language:"ru-RU"}}).then((function(t){e.setState({movieDetails:t,isLoading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.movieDetails,n=e.isLoading,a="https://image.tmdb.org/t/p/w500".concat(t.backdrop_path);return n?Object(T.jsx)(Fe,{}):Object(T.jsxs)(s.a.Fragment,{children:[Object(T.jsx)("section",{className:"movie-overview",style:{backgroundImage:"url(".concat(a,")")},children:Object(T.jsx)("div",{className:"container",children:Object(T.jsxs)("div",{className:"row justify-content-center",children:[Object(T.jsx)("div",{className:"col-4",children:Object(T.jsx)(pe,{path:t.poster_path,width:"100%",alt:""})}),Object(T.jsx)("div",{className:"col-6",children:Object(T.jsx)(Ee,{title:t.title,overview:t.overview,vote_average:t.vote_average,movieId:t.id})})]})})}),Object(T.jsx)(Te,{movieDetails:t})]})}}]),n}(s.a.Component),Re=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.item;return Object(T.jsx)("div",{className:"card",children:Object(T.jsxs)("div",{className:"card-body card-movie",children:[Object(T.jsx)("div",{className:"card-movie_img",children:Object(T.jsx)(U.b,{to:"/movie/".concat(e.id,"/details"),children:Object(T.jsx)(pe,{className:"card-img-top card-img--height",alt:"",path:e.poster_path||e.backdrop_path})})}),Object(T.jsxs)("div",{className:"card-movie_description",children:[Object(T.jsxs)("div",{className:"card-movie_icons",children:[Object(T.jsx)(me,{vote_average:e.vote_average}),Object(T.jsx)(ce,{movieId:e.id}),Object(T.jsx)(de,{movieId:e.id})]}),Object(T.jsx)(U.b,{className:"card-title card-movie_name",to:"/movie/".concat(e.id,"/details"),children:e.title}),Object(T.jsx)("div",{className:"card-movie_details",children:Object(T.jsx)(U.b,{to:"/movie/".concat(e.id,"/details"),children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})})]})]})})}}]),n}(s.a.Component),Ue=function(e){var t=e.movies;return Object(T.jsx)("div",{className:"row",children:t.map((function(e){return Object(T.jsx)("div",{className:"col-6 mb-5",children:Object(T.jsx)(Re,{item:e})},e.id)}))})};Ue.defaultProps={movies:[]};var Be=R(function(e){return function(t){Object(u.a)(a,t);var n=Object(d.a)(a);function a(){var e;return Object(c.a)(this,a),(e=n.call(this)).getFavoriteMovies=function(t,n){var a=t.sort_by,i={language:"ru-RU",page:n,session_id:e.props.auth.session_id,sort_by:a},s=e.props.auth;s.session_id?e.setState({isLoading:!1},(function(){L.get("/account/".concat(s.user.id,"/favorite/movies"),{params:i}).then((function(t){e.props.onChangePagination(n,t.total_pages),e.setState({favoriteMovies:t.results})}))})):e.setState({isLoading:!0})},e.state={favoriteMovies:[]},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getFavoriteMovies(this.props.filters,this.props.pagination.page)}},{key:"componentDidUpdate",value:function(e){fe.a.isEqual(this.props.filters,e.filters)||this.getFavoriteMovies(this.props.filters,1),this.props.pagination.page!==e.pagination.page&&this.getFavoriteMovies(this.props.filters,this.props.pagination.page)}},{key:"render",value:function(){var t=this.state.favoriteMovies;return Object(T.jsx)(e,{movies:t})}}]),a}(s.a.Component)}(Ue)),Ge=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.sort_by,n=e.onChangeFilters,a=e.options;return Object(T.jsxs)("div",{className:"form-group",children:[Object(T.jsx)("label",{htmlFor:"sort_by",children:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"}),Object(T.jsx)("select",{id:"sort_by",className:"form-control",name:"sort_by",value:t,onChange:n,children:a.map((function(e){return Object(T.jsx)("option",{value:e.value,children:e.label},e.value)}))})]})}}]),n}(s.a.Component);Ge.defaultProps={options:[{label:"C\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439  \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e:",value:"created_at.desc"},{label:"C\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e:",value:"created_at.asc"}]};var He=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.filters.sort_by,n=e.pagination,a=n.page,i=n.total_pages,s=e.onChangeFilters,r=e.onChangePagination,o=e.onReset;return Object(T.jsxs)("form",{className:"filters_form",children:[Object(T.jsx)("div",{children:Object(T.jsx)("button",{type:"button",className:"btn btn-outline-dark clear-btn",onClick:o,children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"})}),Object(T.jsx)(Ge,{sort_by:t,onChangeFilters:s}),Object(T.jsx)(ee,{page:a,total_pages:i,onChangePagination:r})]})}}]),n}(s.a.Component),Ve=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChangeFilters=function(t){var n=t.target.value,a=t.target.name;e.setState((function(e){return{filters:Object(v.a)(Object(v.a)({},e.filters),{},Object(V.a)({},a,n))}}))},e.onChangePagination=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.pagination.total_pages;e.setState((function(e){return{pagination:Object(v.a)(Object(v.a)({},e.pagination),{},{page:t,total_pages:n})}}))},e.onReset=function(){e.setState(Object(v.a)({},e.initialState))},e.initialState={filters:{sort_by:"created_at.asc",primary_release_year:"",with_genres:[]},pagination:{page:1,total_pages:1}},e.state=Object(v.a)({},e.initialState),e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state,t=e.filters,n=e.pagination;return Object(T.jsx)("div",{className:"container",children:Object(T.jsxs)("div",{className:"row mt-4",children:[Object(T.jsx)("div",{className:"col-3",children:Object(T.jsx)("div",{className:"card w-100",children:Object(T.jsxs)("div",{className:"card-body",children:[Object(T.jsx)("h3",{children:"\u0424\u0438\u043b\u044c\u0442\u0440\u044b:"}),Object(T.jsx)(He,{pagination:n,filters:t,onChangeFilters:this.onChangeFilters,onChangePagination:this.onChangePagination,onReset:this.onReset})]})})}),Object(T.jsx)("div",{className:"col-9",children:Object(T.jsx)(Be,{filters:t,pagination:n,onChangePagination:this.onChangePagination})})]})})}}]),n}(s.a.Component),qe=R(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.auth,n=e.authActions;t.session_id&&n.fetchAuth(t.session_id)}},{key:"render",value:function(){return Object(T.jsx)(U.a,{basename:"/movies",children:Object(T.jsxs)("div",{children:[Object(T.jsx)(K,{}),Object(T.jsx)(Ce.a,{exact:!0,path:"/",component:ye}),Object(T.jsx)(Ce.a,{path:"/movie/:id",component:Ie}),Object(T.jsx)(Ce.a,{path:"/account/:id/favorite/movies",component:Ve})]})})}}]),n}(s.a.Component)),We=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,140)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),s(e),r(e)}))},Je=(n(114),n(115),n(69)),$e=new(n(72).a),Qe=n(70),ze={user:null,session_id:$e.get("session_id"),showLoginModal:!1,favoriteMovies:[]},Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(v.a)(Object(v.a)({},e),{},{user:t.payload.user,session_id:t.payload.session_id});case g:return Object(v.a)(Object(v.a)({},e),{},{session_id:null,user:null});case f:return Object(v.a)(Object(v.a)({},e),{},{showLoginModal:!e.showLoginModal});case x:return Object(v.a)(Object(v.a)({},e),{},{favoriteMovies:t.payload});default:return e}},Xe=Object(O.combineReducers)({auth:Ke}),Ye=Object(O.createStore)(Xe,Object(Qe.composeWithDevTools)(Object(O.applyMiddleware)(Je.a,(function(e){e.dispatch,e.getState;return function(e){return function(t){return t.type===_&&$e.set("session_id",t.payload.session_id,{path:"/",maxAge:2592e3}),t.type===g&&$e.remove("session_id"),e(t)}}}))));o.a.render(Object(T.jsx)(m.a,{store:Ye,children:Object(T.jsx)(qe,{})}),document.getElementById("root")),We()},80:function(e,t,n){}},[[116,1,2]]]);
//# sourceMappingURL=main.4301cfc6.chunk.js.map